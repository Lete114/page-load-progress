<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script src="../page-load-progress.js"></script>
    <a href="success.html">success</a>
    <a href="error.html">error</a>
    <button>progress</button>
    <script>
      const style = document.createElement('style')
      style.textContent = `
      .progress{
          top: 0; 
          left: 0;
          position: fixed;
          width: 10%;
          height: 2px;
          z-index: 103;
          background-color: #e58a8a;
          transition: width 0.4s ease 0s;
      }`
      document.body.appendChild(style)

      document.addEventListener('progress:start', () => {
        var progress = 10
        var div = document.createElement('div')
        div.className = 'progress'
        document.body.prepend(div)
        var max = 10,
          mini = 3
        var result = max - mini
        setInterval(function () {
          var num = parseInt(Math.random() * result)
          var randomResult = num + mini
          progress += randomResult
          if (progress > 95) progress = 95
          document.getElementsByClassName('progress')[0].style.width = progress + '%'
        }, 500)
      })

      document.addEventListener('progress:end', () => {
        var progress = document.getElementsByClassName('progress')
        progress[0].style.width = '100%'
        setTimeout(function () {
          progress[0].parentNode.removeChild(progress[0])
        }, 700)
      })
    </script>
  </body>
</html>
